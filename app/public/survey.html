<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FrendFndr Survey</title>
    <!-- Jquery CDN -->
    <script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
    <!-- fonts -->
    <link href="https://fonts.googleapis.com/css?family=Zilla+Slab:300,400,500" rel="stylesheet">
    <!-- CSS -->
    <link rel="stylesheet" type="text/css" href="css/reset.css">
    <link rel="stylesheet" type="text/css" href="css/style.css">
    <link rel="stylesheet" type="text/css" href="css/survey-style.css">
</head>

<body>
    <!-- friend match modal -->
    <section>
        <div class="matchModal">
         <div id="giveModal"><span class="xClose">&times;</span></div>
        <img class="matchIcon" src="images/FF-logo1.svg" alt="friend match icon">
            <h1 class="modalHead">Meet your match and start a conversation</h1>

        </div>
    </section>
    <!--  survey form page -->
    <main id="surveyWrapper">
        <button class="backArrow back-btn">&#10140;</button>
        <div class=head>
            <img class="back-btn" src="images/FF-logo2.svg" alt="Friend finder logo" style="width: 100px">
        </div>
        <form class="inputWrapper">
            <section class="rowWrapper">
                <div class="form-row col-6">
                    <input id="firstName" class="validate" type="text" name="first name" class="form" placeholder="First Name" required>
                    <label for="firstNmae">first name</label>
                </div>
                <div class="form-row col-6">
                    <input id="lastName" class="validate" type="text" name="last name" class="form" placeholder="Last Name" required>
                    <label for="lastName">last name</label>
                </div>
            </section>
            <section class="rowWrapper">
                <div class="form-row col-12">
                    <input id="email-input" class="validate" type="email" name="email" placeholder="Enter valid email address" required></input>
                    <label for="email">email address</label>
                </div>
            </section>
            <section class="rowWrapper">
                <div class="form-row col-12">
                    <input id="photo" class="validate" type="text" name="link to photo" placeholder="Enter link to your photo" required>
                    <label for="photo">link to photo</label>
                </div>
            </section>
        </form>
        <form>
            <div class="surveyRow">
                <div class="quest-block col-6">
                    <h3 class="question"><span >1. </span>Your mind is always buzzing with unexplored ideas and plans.</h3>
                    <select id="quest-1" class="qValid" name="1" required>
                        <option value="" disabled selected hidden>Select on a scale of 1 to 5</option>
                        <option value="5">😁 | Strongly agree</option>
                        <option value="4">😌 | Agree</option>
                        <option value="3">😐 | Neutral</option>
                        <option value="2">😕 | Slightly disagree</option>
                        <option value="1">😖 | Strongly disagree</option>
                    </select>
                </div>
                <div class="quest-block col-6">
                    <h3 class="question"><span>2. </span>Generally speaking, you rely more on your experience than your imagination.</h3>
                    <select id="quest-2" class="qValid" name="2" required>
                        <option value="" disabled selected hidden>Select on a scale of 1 to 5</option>
                        <option value="5">😁 | Strongly agree</option>
                        <option value="4">😌 | Agree</option>
                        <option value="3">😐 | Neutral</option>
                        <option value="2">😕 | Slightly disagree</option>
                        <option value="1">😖 | Strongly disagree</option>
                    </select>
                </div>
            </div>
            <div class="surveyRow">
                <div class="quest-block col-6">
                    <h3 class="question"><span>3. </span>You find it easy to stay relaxed and focused even when there is some pressure.</h3>
                    <select id="quest-3" class="qValid" name="3" required>
                        <option value="" disabled selected hidden>Select on a scale of 1 to 5</option>
                        <option value="5">😁 | Strongly agree</option>
                        <option value="4">😌 | Agree</option>
                        <option value="3">😐 | Neutral</option>
                        <option value="2">😕 | Slightly disagree</option>
                        <option value="1">😖 | Strongly disagree</option>
                    </select>
                </div>
                <div class="quest-block col-6">
                    <h3 class="question"><span>4. </span>You rarely get carried away by fantasies and ideas.</h3>
                    <select id="quest-4" class="qValid" name="4" required>
                        <option value="" disabled selected hidden>Select on a scale of 1 to 5</option>
                        <option value="5">😁 | Strongly agree</option>
                        <option value="4">😌 | Agree</option>
                        <option value="3">😐 | Neutral</option>
                        <option value="2">😕 | Slightly disagree</option>
                        <option value="1">😖 | Strongly disagree</option>
                    </select>
                </div>
            </div>
            <div class="surveyRow">
                <div class="quest-block col-6">
                    <h3><span>5. </span>You rarely get carried away by fantasies and ideas.</h3>
                    <select id="quest-5" class="qValid" name="5" required>
                        <option value="" disabled selected hidden>Select on a scale of 1 to 5</option>
                        <option value="5">😁 | Strongly agree</option>
                        <option value="4">😌 | Agree</option>
                        <option value="3">😐 | Neutral</option>
                        <option value="2">😕 | Slightly disagree</option>
                        <option value="1">😖 | Strongly disagree</option>
                    </select>
                </div>
                <div class="quest-block col-6">
                    <h3><span>6. </span>It is often difficult for you to relate to other people’s feelings.</h3>
                    <select id="quest-6" class="qValid" name="6" required>
                        <option value="" disabled selected hidden>Select on a scale of 1 to 5</option>
                        <option value="5">😁 | Strongly agree</option>
                        <option value="4">😌 | Agree</option>
                        <option value="3">😐 | Neutral</option>
                        <option value="2">😕 | Slightly disagree</option>
                        <option value="1">😖 | Strongly disagree</option>
                    </select>
                </div>
            </div>
            <div class="surveyRow">
                <div class="quest-block col-6">
                    <h3><span>7. </span>In a discussion, truth should be more important than people’s sensitivities.</h3>
                    <select id="quest-7" class="qValid" name="7" required>
                        <option value="" disabled selected hidden>Select on a scale of 1 to 5</option>
                        <option value="5">😁 | Strongly agree</option>
                        <option value="4">😌 | Agree</option>
                        <option value="3">😐 | Neutral</option>
                        <option value="2">😕 | Slightly disagree</option>
                        <option value="1">😖 | Strongly disagree</option>
                    </select>
                </div>
                <div class="quest-block col-6">
                    <h3><span>8. </span>You rarely get carried away by fantasies and ideas.</h3>
                    <select id="quest-8" class="qValid" name="8" required>
                        <option value="" disabled selected hidden>Select on a scale of 1 to 5</option>
                        <option value="5">😁 | Strongly agree</option>
                        <option value="4">😌 | Agree</option>
                        <option value="3">😐 | Neutral</option>
                        <option value="2">😕 | Slightly disagree</option>
                        <option value="1">😖 | Strongly disagree</option>
                    </select>
                </div>
            </div>
            <div class="surveyRow">
                <div class="quest-block col-6">
                    <h3><span>9. </span>You think that everyone’s views should be respected regardless of whether they are supported by facts or not.</h3>
                    <select id="quest-9" class="qValid" name="9" required>
                        <option value="" disabled selected hidden>Select on a scale of 1 to 5</option>
                        <option value="5">😁 | Strongly agree</option>
                        <option value="4">😌 | Agree</option>
                        <option value="3">😐 | Neutral</option>
                        <option value="2">😕 | Slightly disagree</option>
                        <option value="1">😖 | Strongly disagree</option>
                    </select>
                </div>
                <div class="quest-block col-6">
                    <h3><span>10. </span>You feel more energetic after spending time with a group of people.</h3>
                    <select id="quest-10" class="qValid" name="10" required>
                        <option value="" disabled selected hidden>Select on a scale of 1 to 5</option>
                        <option value="5">😁 | Strongly agree</option>
                        <option value="4">😌 | Agree</option>
                        <option value="3">😐 | Neutral</option>
                        <option value="2">😕 | Slightly disagree</option>
                        <option value="1">😖 | Strongly disagree</option>
                    </select>
                </div>
            </div>
        </form>
        <div id="btn-wrapper">
            <button class="submit-Btn" role="button">
                <span>submit survey</span>
                <div class="success">&#10004;</div>
                <!-- <div class="btn-rollover">send it!</div> -->
            </button>
        </div>
        <section class="foot">
            <a href="/API/list">API Friend List</a> |
            <a href="https://github.com/rspica/FriendFinder/blob/master/README.md" target="_blank"> GitHub Repo</a>
        </section>
    </main>
    <script>
    $(document).ready(function() {
        console.log('ready on survey')

        // form validation for type inputs and select option inputs
        function formValidate() {
            let isValid = true;
            console.log('in form val')
            $('.validate').each(function() {
                if ($(this).val() === '' || $(this).val() === ' ') {
                    alert('Oops you left the ' + this.name + ' field blank');
                    isValid = false;
                }
            });

            $('.qValid').each(function() {
                if ($(this).val() === null) {
                    alert('Hey you forgot question ' + this.name + ' it\'s blank');
                    isValid = false;
                } 
            });
            return isValid;
        };

        // function to collect input values on form and survey
        function inputValue(value) {
            return $(value).val().trim();
        }
        // forn and survey resets after value capture
        function surveyReset(value) {
            $(value).val('');
        }

        function resetFormInput() {
            $('#firstName').val('');
            $('#lastName').val('');
            $('#email-input').val('');
            $('#photo').val('');
        }

        //===============  Event handlers  ==================
        //===================================================
        // Back button events for logo and back arrow
        const wrapper = $("#surveyWrapper");

        $(document).on('click', '.back-btn', function(e) {
            e.preventDefault();
            e.stopPropagation();
            wrapper.css("right", "-50%");
            console.log('yep clicked');
            setTimeout(function(){
                window.location='/';
            }, 750);

        });


        // Event to get values from survey and form field
        $(document).on('click', '.submit-Btn', function(e) {
            e.preventDefault();
            e.stopPropagation();
            isValid = formValidate();

            const questions = [];
            const quest = ['#quest-1', '#quest-2', '#quest-3', '#quest-4', '#quest-5', '#quest-6', '#quest-7',
                '#quest-8', '#quest-9', '#quest-10'];

            if (isValid) {    
                quest.forEach(function(elem) { // loop through and pull off each of the survery question user selects
                    console.log('elem off of each(): ',elem)
                    const response = inputValue(elem);
                    questions.push(response);
                    surveyReset(elem);
                });

                var newFriend = {
                    firstName: inputValue('#firstName'),
                    lastName: inputValue('#lastName'),
                    email: inputValue('#email-input'),
                    photo: inputValue('#photo'),
                    scores: questions
                };

                console.log("new submission: ", newFriend);
                console.log('Question responses: ',questions)

                $.post("data/friends", newFriend, function(data) {
                    console.log(data)
                });

                const success = $('.success'); // ui action on submit button
                success.addClass('iconCHK');
                setTimeout(function() {
                    success.removeClass('iconCHK')
                }, 2500);

                const matchModal = $('.matchModal'); // ui action on modal drop-down
                matchModal.addClass('.match');

                // const xClose = $('.xClose');
                // xClose.removeClass$('.match');
                resetFormInput();
            }
        });
    });
    </script>
</body>

</html>